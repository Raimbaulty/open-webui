"""
title: 关闭思考
description: 为模型名称添加 -think-0 后缀关闭思考
"""

from pydantic import BaseModel, Field
from typing import Optional, List, Dict, Any


class Filter:
    class Valves(BaseModel):
        priority: int = Field(default=100, description="优先级")
        pass

    def __init__(self):
        self.valves = self.Valves()
        self.toggle = True
        self.icon = """data:image/svg+xml;charset=utf-8;base64,PHN2ZyB0PSIxNzU1MTY3MTUzMjMwIiBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjU3NDUiIHdpZHRoPSIyMDAiIGhlaWdodD0iMjAwIj48cGF0aCBkPSJNMjk4LjY2NjY2NyAyNTZjMCAxMC4xMTIgMS43MDY2NjcgMTkuNzEyIDQuOTA2NjY2IDI4LjU4NjY2N2E0Mi42NjY2NjcgNDIuNjY2NjY3IDAgMCAxLTQyLjY2NjY2NiA1Ni44NzQ2NjYgODUuMzMzMzMzIDg1LjMzMzMzMyAwIDAgMC02OC41NjUzMzQgMTQyLjA4IDQyLjY2NjY2NyA0Mi42NjY2NjcgMCAwIDEgMC4wNDI2NjcgNTYuOTE3MzM0IDg1LjM3NiA4NS4zNzYgMCAwIDAgMzYuODY0IDEzNy45NDEzMzMgNDIuNjY2NjY3IDQyLjY2NjY2NyAwIDAgMSAyOC41ODY2NjcgNDguNDI2NjY3IDEwNi42NjY2NjcgMTA2LjY2NjY2NyAwIDAgMCAyMTAuNDMyIDM1LjE1NzMzM2MwLjI1Ni0xLjgzNDY2NyAwLjU5NzMzMy0zLjU0MTMzMyAxLjA2NjY2Ni01LjI0OFYyNTZhODUuMzMzMzMzIDg1LjMzMzMzMyAwIDEgMC0xNzAuNjY2NjY2IDB6IG0yNTYgNTAwLjczNmMwLjQyNjY2NyAxLjcwNjY2NyAwLjg1MzMzMyAzLjQxMzMzMyAxLjA2NjY2NiA1LjIwNTMzM2ExMDYuNjY2NjY3IDEwNi42NjY2NjcgMCAxIDAgMjEwLjQzMi0zNS4xMTQ2NjYgNDIuNjY2NjY3IDQyLjY2NjY2NyAwIDAgMSAyOC41ODY2NjctNDguNDI2NjY3IDg1LjM3NiA4NS4zNzYgMCAwIDAgMzYuODY0LTEzNy45NDEzMzMgNDIuNjY2NjY3IDQyLjY2NjY2NyAwIDAgMSAwLTU2LjkxNzMzNCA4NS4zMzMzMzMgODUuMzMzMzMzIDAgMCAwLTY4LjU2NTMzMy0xNDIuMDggNDIuNjY2NjY3IDQyLjY2NjY2NyAwIDAgMS00Mi42MjQtNTYuODc0NjY2QTg1LjMzMzMzMyA4NS4zMzMzMzMgMCAxIDAgNTU0LjY2NjY2NyAyNTZ2NTAwLjczNnpNMzg0IDg1LjMzMzMzM2ExNzAuMjQgMTcwLjI0IDAgMCAxIDEyOCA1Ny43NzA2NjcgMTcwLjY2NjY2NyAxNzAuNjY2NjY3IDAgMCAxIDI5OC41ODEzMzMgMTE4LjIyOTMzM0ExNzAuNzUyIDE3MC43NTIgMCAwIDEgOTE1Ljg0IDUxMiAxNzAuNTM4NjY3IDE3MC41Mzg2NjcgMCAwIDEgODUzLjMzMzMzMyA3NDUuMTczMzMzdjEuNDkzMzM0YTE5MiAxOTIgMCAwIDEtMzQxLjMzMzMzMyAxMjAuNjYxMzMzQTE5MiAxOTIgMCAwIDEgMTcwLjY2NjY2NyA3NDYuNjY2NjY3di0xLjQ5MzMzNEExNzAuNTM4NjY3IDE3MC41Mzg2NjcgMCAwIDEgMTA4LjE2IDUxMmExNzAuNzUyIDE3MC43NTIgMCAwIDEgMTA1LjI1ODY2Ny0yNTAuNjI0QTE3MC42NjY2NjcgMTcwLjY2NjY2NyAwIDAgMSAzODQgODUuMzMzMzMzeiIgZmlsbD0iIzAwMDAwMCIgcC1pZD0iNTc0NiI+PC9wYXRoPjwvc3ZnPg=="""
        pass

    def inlet(self, body: dict, user: Optional[dict] = None) -> dict:
        model_name = body.get("model")
        if isinstance(model_name, str):
            # 检查模型名称是否已经包含"-think-0"后缀，避免重复添加
            if "-think-0" not in model_name:
                # 如果模型名称以"-search"结尾，需要将"-think-0"插入到"-search"前面
                if model_name.endswith("-search"):
                    base_name = model_name[:-7]  # 移除"-search"
                    body["model"] = base_name + "-think-0-search"
                else:
                    # 直接在模型名称后面添加"-think-0"后缀
                    body["model"] = model_name + "-think-0"
        return body
